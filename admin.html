<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>顧客滿意度管理後台</title>
  <style>
    body { font-family: "Microsoft JhengHei", sans-serif; background: #fafbfa; }
    h2 { color: #3a6d4f; text-align: center; }
    table { border-collapse: collapse; margin: 20px auto; width: 96%; background: #fff; box-shadow: 0 2px 12px #0001;}
    th, td { border: 1px solid #ddd; padding: 8px 12px; text-align: left; }
    th { background: #e8f5e9; color: #257953;}
    tr:nth-child(even) { background: #f7faf7; }
    .refresh { margin: 18px auto; display: block; }
  </style>
</head>
<body>
  <h2>顧客滿意度調查後台表格</h2>
  <button class="refresh" onclick="fetchSheet()">重新整理資料</button>
  <div id="sheetTable" style="overflow:auto"></div>

  <script>
    // 已填入你的 Google Sheets ID 跟分頁名稱
    const SHEET_ID = '18FfswK_Y5qw3Fr72WwjpMEQSUyfoT2JjknHuEHswefU';
    const SHEET_NAME = '工作表1';

    async function fetchSheet() {
      document.getElementById('sheetTable').innerHTML = '載入中...';
      const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=${encodeURIComponent(SHEET_NAME)}`;
      try {
        const res = await fetch(url);
        const csv = await res.text();
        const rows = csv.trim().split('\n').map(row => row.split(','));
        let html = '<table><thead><tr>' + rows[0].map(h=>`<th>${h}</th>`).join('') + '</tr></thead><tbody>';
        for(let i=1; i<rows.length; i++) {
          html += '<tr>' + rows[i].map(c=>`<td>${c.replace(/"/g, '')}</td>`).join('') + '</tr>';
        }
        html += '</tbody></table>';
        document.getElementById('sheetTable').innerHTML = html;
      } catch (e) {
        document.getElementById('sheetTable').innerHTML = '載入失敗！請確認表單設定為公開或再試一次';
      }
    }
    fetchSheet();
  </script>
</body>
</html>
